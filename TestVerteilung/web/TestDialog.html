<!DOCTYPE html>
<html lang="en"><head>


    <meta charset="utf-8"><title>jQuery UI Dialog - Modal form</title>

    <script src="./src/main/javascript/ace/ace.js" type="text/javascript" charset="utf-8"></script>
    <script src="./src/main/javascript/ace/theme-chrome.js" type="text/javascript" charset="utf-8"></script>
    <script src="./src/main/javascript/ace/theme-eclipse.js" type="text/javascript" charset="utf-8"></script>
    <script src="./src/main/javascript/ace/mode-xml.js" type="text/javascript" charset="utf-8"></script>
    <script src="./src/main/javascript/ace/mode-javascript.js" type="text/javascript" charset="utf-8"></script>
    <script src="./src/main/javascript/ace/mode-text.js" type="text/javascript" charset="utf-8"></script>

    <script type="text/javascript" src="./src/main/javascript/alfrescoClient.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/dialoge.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/recognition.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/verteilung.js"  charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery-ui/js/jquery-1.10.2.js"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery-ui/js/jquery-ui-1.10.4.custom.js"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.tmpl.min.js"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.layout.js"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.layout.resizeTabLayout-1.3.js"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.cookie.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.hotkeys.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.jstree.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.themeswitcher.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.dataTables.js" charset="utf-8"></script>
    <script type="text/javascript" src="./src/main/javascript/jquery.price-format.js" charset="utf-8"></script>

    <script type="text/javascript" src="./src/main/javascript/alpaca/alpaca/alpaca.js"></script>

    <script src="./src/main/javascript/vkbeautify.js" type="text/javascript" charset="utf-8"></script>
    <script src="./src/main/javascript/jsbeautify.js" type="text/javascript" charset="utf-8"></script>

    <link type="text/css" href="./src/main/javascript/alpaca/alpaca/alpaca.css" rel="stylesheet"/>
    <link type="text/css" href="./src/main/resource/simplegrid.css" rel="stylesheet"/>
    <link type="text/css" href="./src/main/resource/ArchivLayout.css" rel="stylesheet"/>
    <link type="text/css" href="./src/main/javascript/jquery-ui/css/cupertino/jquery-ui-1.10.4.custom.css" rel="stylesheet"/>


    <script>



    $(function() {

            var dialogSettings = { "id": "settingsDialog",
                "schema": {
                    "type": "object",
                    "title": "Dokument Einstellungen",
                    "properties": {
                        "name": {
                            "type": "string",
                            "title": "Dateiname",
                            "required": false
                        },
                        "titel": {
                            "type": "string",
                            "title": "Titel",
                            "required": true
                        },

                        "beschreibung": {
                            "type": "string",
                            "title": "Beschreibung",
                            "required": false
                        },
                        "person": {
                            "type": "string",
                            "title": "Person",
                            "enum":[
                                "Klaus",
                                "Katja",
                                "Till",
                                "Kilian"
                            ],
                            "required": true
                        },
                        "betrag": {
                            "type": "number",
                            "title": "Betrag",
                            "required": false
                        },
                        "datum": {
                            "type": "string",
                            "format":"date",
                            "title": "Datum",
                            "required": true
                        },
                        "kennung": {
                            "type": "string",
                            "title": "Id",
                            "required": false
                        },
                        "steuer": {
                            "type": "boolean",
                            "title":"Steuern",
                            "required": false
                        }
                    }
                },

                "options": {
                    "renderForm": true,
                    "form":{


                        "buttons":{
                            "submit":{"value":"Sichern"},
                            "reset":{"value":"Abbrechen"}
                        }
                    },
                    "fields": {

                        "titel": {
                            "size": 30

                        },
                        "name": {
                            "size": 30,
                            "readonly": true
                        },
                        "beschreibung": {
                            "type": "textarea",
                            "size": 150
                        },
                        "steuer": {
                            "rightLabel": "relevant"
                        },
                        "datum": {
                            "dateFormatRegex": "/(0[1-9]|[12][0-9]|3[01])\.(0[1-9]|1[012])\.(19|20)\d\d$/",
                            "dateFormat":"dd.mm.yy"
                        },
                        "betrag":{
                            "type": "currency",
                             "centsSeparator": ",",
                            "prefix": "",
                            "suffix": " €",
                            "thousandsSeparator": "."
                        }

                    }
                },
                "data": {
                    "name": "1234.pdf",
                    "steuer": false,
                    "datum": getCurrentDate("dd.m.YYYY"),
                    "person": "Klaus",
                    "betrag":"25,00 €"
                },
                "view": {
                    "parent": "VIEW_WEB_EDIT",
                    "layout": {
                        "template": "threeColumnGridLayout",
                        "bindings": {
                            "name":"column-1-1",
                            "titel":"column-1-1",

                            "beschreibung":"column-1-1",
                            "person":"column-1-2",
                            "datum":"column-2-2",
                            "betrag":"column-1-2",
                            "kennung":"column-2-2",
                            "steuer":"column-1-2"

                        }
                    },
                    "templates": {
                        "threeColumnGridLayout": '<div class="filter-content">' + '{{if options.label}}<h2>${options.label}</h2><span></span>{{/if}}' + '{{if options.helper}}<p>${options.helper}</p>{{/if}}'
                                + '<div id="column-1-1" class="col-1-1"> </div>'
                                + '<div id="column-1-2" class="col-1-2"> </div> <div id="column-2-2" class="col-1-2"> </div>'

                                + '<div id="column-1-7_12" class="col-7-12"> </div> <div id="column-2-5_12" class="col-5-12"> </div>'
                                + '<div id="column-1-3" class="col-1-3"> </div> <div id="column-2-3" class="col-1-3"> </div> <div id="column-3-3" class="col-1-3"> </div>'
//                                + '<div id="column-1" class="grid_6"> </div>' + '<div id="column-2" class="grid_6"> </div>' + '<div class="grid_8 push_8"> <div id="column-3" class="grid_6"> </div> </div>' +  '<div class="clear"></div>'
//                                + '<div id="column-1-2" class="grid_3"> </div>' + '<div id="column-2" class="grid_6"> </div>' + '<div class="clear"></div>'
                                + '</div>'
                    }

                },
                "ui": "jquery-ui"  ,
                "postRender": function(renderedField) {
                    var form = renderedField.form;
                    if (form) {
                        form.registerSubmitHandler(function(e) {
                            if (form.isFormValid()) {
                                try {
                                    var server = $("[name='server']").val(),
                                            user = $("[name='user']").val(),
                                            password = $("[name='password']").val();
                                    if (!server.endsWith("/"))
                                        server = server + "/";
                                    $('#dialogBox').dialog("destroy");
                                alert(server + "\n" + user+ "\n" + password);
                                } catch (e) {
                                    errorHandler(e);
                                }
                            }
                        });
                    }
                }

            } ;

            var dialogLayout;
            /*var server = $( "#server" ),
                    user = $( "#user" ),
                    password = $( "#password" ),
                    allFields = $( [] ).add( server ).add( user ).add( password ),
                    tips = $( ".validateTips" );*/
            function updateTips( t ) {
                tips
                        .text( t )
                        .addClass( "ui-state-highlight" );
                setTimeout(function() {
                    tips.removeClass( "ui-state-highlight", 1500 );
                }, 500 );
            }
            function checkLength( o, n, min, max ) {
                if ( o.val().length > max || o.val().length < min ) {
                    o.addClass( "ui-state-error" );
                    updateTips( "Length of " + n + " must be between " +
                            min + " and " + max + "." );
                    return false;
                } else {
                    return true;
                }
            }
            function checkRegexp( o, regexp, n ) {
                if ( !( regexp.test( o.val() ) ) ) {
                    o.addClass( "ui-state-error" );
                    updateTips( n );
                    return false;
                } else {
                    return true;
                }
            }


            changeCss('.grid','max-width: 100%; min-width:100%');
            changeCss('input', 'width:100%');
            changeCss('.ui-widget textarea', 'width:100%');
            changeCss('select','max-width: 100%; min-width:10%');
            changeCss('.alpaca-controlfield-checkbox input', 'margin-top:-1px');
            changeCss("input[type='checkbox']", 'width:10px;float:left');
            changeCss('h2','background-color: transparent; background-image: url("./src/main/resource/images/alfresco.png"); background-repeat: no-repeat; background-position: left; height: 24px; border: 0; padding-left: 28px; padding-top: 4px');

            $('<div id="dialogBox">').append(Alpaca($('<div id="form" class="grid grid-pad">'), dialogSettings)).dialog({
                autoOpen: false,
                width: 420,
                height:'auto',
                modal: true,
                open: function(){
                    $(".alpaca-form-buttons-container").addClass("ui-dialog-buttonpane ui-widget-content");
                    $(".alpaca-form-button-submit").button();
                    $(".alpaca-form-button-reset").button().click(function(){  $('#dialogBox').dialog("close"); });
                 /*   $(".alpaca-form-button-submit").addClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only");
                    $(".alpaca-form-button-submit").css({padding: "0.4em 1em 0.4em 1em"});
                    $(".alpaca-form-button-reset").addClass("ui-button ui-widget ui-state-default ui-corner-all ui-button-text-only");
                    $(".alpaca-form-button-reset").css({padding: "0.4em 1em 0.4em 1em"});
                    $(".alpaca-form-button-reset").click(function(){  $('#dialogBox').dialog("close"); });
                    $(".alpaca-form-buttons-container").addClass("ui-dialog-buttonpane ui-widget-content");*/
                }
            });
            $( "#create-user" )
                    .button()
                    .click(function() {
                        $('#dialogBox').dialog("open");
                    });
        });
    </script></head><body>

<button id="create-user">Create new user</button>
</body></html>